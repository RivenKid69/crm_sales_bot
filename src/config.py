"""
Конфигурация: состояния, интенты, база знаний, шаблоны
"""

# =============================================================================
# ИНТЕНТЫ: КОРНИ СЛОВ (быстрая проверка)
# =============================================================================

INTENT_ROOTS = {
    "greeting": [
        # Стандартные приветствия
        "привет", "здравств", "добр", "хай", "приветств", "салют", "хелло", "хэлло",
        # Разговорные варианты
        "прив", "здаров", "здарова", "дарова", "даров", "йо", "хаюшки", "хаю",
        "приветик", "привки", "ку", "здрасьте", "здрасте", "здасте",
        # Формальные
        "доброго", "приветствую",
        # Дополнительные разговорные
        "дратути", "превед", "приф", "прива", "здоров", "хеллоу", "хело",
        "приветос", "приветули", "здравия", "бонжур", "хола",
        # Время суток
        "утречк", "вечерочек", "денечек", "денёчек",
    ],
    "price_question": [
        # Стандартные
        "цен", "стоим", "стоит", "прайс", "почём", "тариф", "расценк", "ценник",
        "бюджет", "деньг", "рубл", "₽", "руб",
        # Разговорные и опечатки
        "почом", "скока", "скольк", "ценик", "прайслист", "прайс-лист",
        "денюжк", "финанс", "оплат", "платёж", "платеж",
        # Косвенные
        "выйдет", "обойд", "потрат", "влет", "затрат",
        # Дополнительные разговорные
        "чё почём", "чо почем", "ценочка", "ценовая", "прайсик", "тарифчик",
        "скоко", "сколь", "скок", "денежк", "деняг", "бабл", "бабок",
        "за сколько", "какой прайс", "скинь прайс", "скинь цен",
        # Сленг
        "чек", "чеков", "влетит", "влетает", "встанет", "встаёт",
        "потянет", "тянет на", "выливает", "стоимост",
        # Вопросы об условиях
        "подешевле", "дешевле можн", "скидос", "скидон",
    ],
    "objection_price": [
        # Стандартные
        "дорог", "дешевл", "скидк", "бесплатн", "денег нет", "не потянем",
        # Разговорные и сленг
        "дороговат", "недёшев", "недешев", "кусает", "кусач", "по карман",
        "накладн", "неподъём", "неподъемн", "не по карман", "жирно",
        # Сравнения
        "конкурент дешевл", "дешевле есть", "у других дешев",
        # Бюджет
        "нет бюджет", "бюджет не позвол", "финансов не хват", "не выдел",
        "не заложен", "ограничен бюджет", "урезали бюджет",
        # Дополнительные
        "дорга", "дорага", "дешивле", "прайс кусает", "жирноват",
        "перебор", "много хотите", "много просите", "завышен",
        "неоправдан", "не стоит таких", "переплат", "не окуп",
        "не отобь", "экономим", "не тянем", "не вытянем",
        "режем расход", "сокращаем затрат", "оптимизируем бюджет",
    ],
    "objection_no_time": [
        # Стандартные
        "нет времен", "занят", "не сейчас", "позж", "потом", "перезвон",
        # Разговорные
        "некогда", "завал", "запар", "аврал", "горит", "дедлайн",
        "в другой раз", "на днях", "через недел", "через месяц",
        "не до этого", "голова забит", "руки не доход",
        # Вежливые отказы
        "давайте позж", "может потом", "сейчас не могу", "напишите позж",
        # Дополнительные
        "времени нет", "не успеваю", "загружен", "зашиваюсь", "зашива",
        "конец квартал", "конец год", "конец месяц", "отчётност",
        "после праздник", "после отпуск", "после нового год",
        "сезон", "высокий сезон", "несезон", "пик нагрузк",
        "разгребу дела", "разгребём", "освобожусь", "освободимся",
        "следующий квартал", "в новом году",
    ],
    "objection_competitor": [
        # CRM-системы
        "битрикс", "амо", "amocrm", "amo crm", "мегаплан", "salesforce",
        "pipedrive", "hubspot", "zoho", "freshsales", "1с:crm", "1c:crm",
        "retailcrm", "envybox", "клиентикс", "простой бизнес",
        # Общие фразы
        "уже есть", "уже пользу", "используем", "работаем в",
        "внедрили", "перешли на", "купили", "подключили",
        # Сравнения
        "у нас своя", "самописн", "написали сам", "своя разработк",
        # Дополнительные CRM
        "террасофт", "terrasoft", "creatio", "s2", "planfix", "планфикс",
        "yclients", "iклиент", "yclients", "мегаплан", "wirecrm",
        "insightly", "monday", "notion", "trello", "asana", "jira",
        # Дополнительные фразы
        "сидим на", "работаем на", "юзаем", "пользуем",
        "устраивает текущ", "менять не хотим", "привыкли", "обучены",
        "вложили деньги", "мигрировать дорого", "переносить данные",
    ],
    "question_features": [
        # Стандартные
        "функци", "возможност", "умеет", "может", "интеграц", "что делает",
        "как работает", "что включ",
        # Расширенные
        "фичи", "фича", "опции", "опция", "способн", "позволя",
        "поддержива", "предоставля", "обеспечива", "реализова",
        "есть ли", "можно ли", "поддержка", "функционал",
        # Сравнительные
        "отличи", "преимущ", "выгод", "плюс", "минус", "особенност",
        "чем лучше", "чем хуже", "в чём разниц",
        # Дополнительные
        "расскаж про", "расскажите про", "покажите как",
        "что умеет", "что может", "что позволяет", "на что способ",
        "фишки", "фишка", "киллер фич", "уникальн",
        "автоматизац", "автоматич", "триггер", "сценари",
        "шаблон", "конструктор", "настройк", "кастомизац",
        "гибкость", "масштабиру", "безопасност", "надёжност",
    ],
    "question_integrations": [
        # Стандартные
        "интеграц", "подключ", "связ", "синхрониз", "1с", "телефон", "почт",
        "whatsapp", "telegram", "битрикс24",
        # Расширенные сервисы
        "viber", "вотсап", "вацап", "телеграм", "инстаграм", "instagram",
        "вконтакте", "vk", "facebook", "фейсбук", "avito", "авито",
        "юла", "циан", "domclick", "яндекс", "yandex", "google", "гугл",
        # Системы и API
        "api", "апи", "webhook", "вебхук", "zapier", "albato", "make",
        "ip-телефон", "sip", "сип", "asterisk", "манго", "mango",
        "мегафон", "билайн", "мтс", "tele2", "теле2", "ростелеком",
        # Бухгалтерия и учёт
        "1с", "мой склад", "мойсклад", "эльба", "контур", "сбис", "sbis",
        # Дополнительные
        "ватсапп", "воцап", "тг", "телега", "инста", "вк", "фб",
        "озон", "ozon", "wildberries", "вайлдберриз", "wb",
        "amo", "битрикс", "бит24", "б24",
        "comagic", "roistat", "ройстат", "calltouch", "колтач",
        "jivosite", "живосайт", "carrot", "чатра", "chatra",
        "sendpulse", "unisender", "mailchimp", "getresponse",
        "tilda", "тильда", "wordpress", "вордпресс", "битрикс сайт",
    ],
    "agreement": [
        # Стандартные
        "интересн", "давайте", "расскажите", "хочу", "готов", "согласен",
        "подходит", "нравится", "да,", "да!", "ок", "хорошо", "годится",
        # Разговорные
        "окей", "ладно", "договорились", "идёт", "идет", "пойдёт", "пойдет",
        "замётано", "заметано", "супер", "класс", "отлично", "круто",
        # Активный интерес
        "покажите", "продемонстрир", "демо", "попробова", "тест", "пробн",
        "запишите", "оформ", "подключ", "начн", "старт",
        # Уточняющий интерес
        "поподробн", "подробн", "детальн", "конкретн", "расскаж ещё",
        "а как", "а что", "а можно",
        # Дополнительные
        "океюшки", "лады", "ладушки", "добро", "принято", "понял",
        "го", "погнали", "поехали", "стартуем", "начинаем",
        "в деле", "зайду", "гляну", "посмотрю", "попробую",
        "заинтересов", "заинтриговал", "звучит интересн", "звучит неплох",
        "любопытн", "хочется попробова", "было бы интересн",
        "почему бы и нет", "можно попробова", "давай попробу",
        "запиши", "записывай", "бронируй", "бронирую",
    ],
    "rejection": [
        # Стандартные
        "не интересн", "не нужн", "не надо", "нет,", "нет!", "отстань",
        "не хочу", "не буд", "отказ", "пока не",
        # Разговорные и резкие
        "отвали", "отвяжи", "достал", "хватит", "прекрат", "стоп",
        "не пиши", "не звони", "заблокир", "в бан", "спам",
        # Вежливые отказы
        "спасибо не надо", "благодарю но", "пожалуй нет", "воздерж",
        "обойдусь", "обойдёмся", "справимся сами", "сами разбер",
        # Скептицизм
        "не верю", "сомнева", "вряд ли", "навряд", "не уверен",
        # Дополнительные
        "неинтересн", "ненужн", "ненадо", "нихачу", "нибуду",
        "без вас обойд", "без вас справ", "пас", "пасс",
        "отписыва", "удали", "убери", "исключи",
        "надоел", "утомил", "замучил", "задолбал",
        "не актуальн", "неактуальн", "не релевантн", "мимо",
        "не наш формат", "не наша тема", "не по адресу",
    ],
    "contact_provided": [
        # Email
        "@", "mail", "почта", "gmail", "yandex", "inbox", "outlook", "rambler",
        "емейл", "имейл", "мейл", "email", "e-mail",
        # Телефон
        "телефон", "позвон", "номер", "мобильн", "сотов", "трубк",
        "набер", "звякн", "созвон", "ватсап пиши", "в телегу пиши",
        # Дополнительные
        "мой номер", "напишите на", "пишите на", "звоните на",
        "вот контакт", "вот телефон", "вот почта", "скину номер",
        "запиши мой", "запишите мой", "записывай",
        "вотсап", "телеграм", "тг", "телега",
    ],
}

# =============================================================================
# ИНТЕНТЫ: ПОЛНЫЕ ФРАЗЫ (для pymorphy2 fallback)
# =============================================================================

INTENT_PHRASES = {
    "greeting": [
        # Стандартные
        "привет", "здравствуйте", "добрый день", "доброе утро", "добрый вечер",
        "хай", "приветствую", "салют",
        # Разговорные
        "прив", "здарова", "дарова", "хаюшки", "приветик", "ку",
        "здрасьте", "доброго времени", "доброго дня",
        # Формальные и вежливые
        "рад приветствовать", "приятно познакомиться", "всем привет",
        # Дополнительные
        "дратути", "превед", "приветос", "здорово", "хеллоу",
        "доброго времени суток", "приветствую вас", "здравия желаю",
        "добренького", "утречко доброе", "добрый денёчек",
    ],
    "price_question": [
        # Стандартные
        "сколько стоит", "какая цена", "прайс", "почём", "стоимость",
        "какой ценник", "по деньгам", "какие тарифы", "какие расценки",
        "сколько это будет стоить", "во сколько обойдётся", "какой бюджет нужен",
        # Вежливые
        "не подскажете стоимость", "можно узнать цену", "подскажите по ценам",
        "интересует стоимость", "хотел бы узнать цену", "скажите сколько",
        # Косвенные
        "интересует финансовая сторона", "что по деньгам", "что по цене",
        "какие условия по оплате", "как по финансам",
        # С контекстом
        "а если на год сколько выйдет", "сколько за месяц", "сколько за пользователя",
        "какая цена за лицензию", "стоимость подписки", "абонентская плата",
        "цена внедрения", "скрытые платежи есть", "есть пробный период",
        # Разговорные
        "чё почём", "скока стоит", "почом будет", "скинь прайс",
        # Дополнительные вежливые
        "не подскажете по стоимости", "сколько это удовольствие стоит",
        "хотелось бы узнать цену", "интересно узнать стоимость",
        "если не секрет сколько", "можете озвучить цену",
        # Дополнительные с контекстом
        "сколько за одно рабочее место", "цена за оператора",
        "сколько если оплатить сразу за год", "есть ли скидка за объём",
        "минимальный пакет сколько стоит", "сколько стоит базовый тариф",
        "какой минимальный платёж", "от какой суммы можно начать",
        "сколько за внедрение берёте", "настройка платная",
        "обучение входит в стоимость", "что входит в цену",
        # Дополнительные разговорные
        "во сколько влетит", "сколько это встанет", "какой чек выйдет",
        "в какую сумму уложимся", "какие денежки нужны",
    ],
    "objection_price": [
        # Стандартные
        "дорого", "слишком дорого", "дешевле есть", "нет бюджета",
        "не потянем", "денег нет", "дороговато",
        # Разговорные
        "цены кусаются", "ценник не по карману", "жирновато",
        "накладно выходит", "неподъёмная сумма",
        # Сравнительные
        "у конкурентов дешевле", "есть варианты подешевле",
        "видел дешевле", "другие предлагают дешевле",
        # Бюджетные
        "бюджет не позволяет", "не заложено в бюджет", "урезали бюджет",
        "выделили мало", "не выделили средства",
        # Скидки
        "есть скидки", "можно дешевле", "скиньте цену", "торг уместен",
        # Дополнительные
        "это перебор", "слишком много хотите", "завышенный ценник",
        "не окупится", "не отобьётся", "рентабельность под вопросом",
        "за эти деньги можно что-то получше", "цена не соответствует",
        "неоправданно дорого", "не стоит таких денег",
        "режем расходы сейчас", "оптимизируем затраты",
        "в кризис не до этого", "экономим каждую копейку",
        "можно бесплатную версию", "есть бесплатный период",
    ],
    "objection_no_time": [
        # Стандартные
        "нет времени", "занят", "не сейчас", "перезвоните позже",
        "давайте потом", "сейчас не могу",
        # Разговорные
        "некогда совсем", "завален работой", "запара на работе", "аврал",
        "горят дедлайны", "конец квартала",
        # Отложенные
        "в другой раз", "на следующей неделе", "через месяц",
        "после праздников", "после отпуска", "давайте в следующем квартале",
        # Вежливые
        "сейчас не лучшее время", "не до этого сейчас", "голова другим забита",
        "руки не доходят", "много других задач",
        # Дополнительные
        "загружены по горло", "зашиваемся", "работы невпроворот",
        "сейчас горячая пора", "высокий сезон у нас",
        "отчётный период", "конец года", "конец месяца",
        "после новогодних праздников", "в январе напишите",
        "пока разгребём текущие дела", "освободимся и свяжемся",
        "может через пару недель", "давайте после выходных",
        "на этой неделе точно нет", "следующий месяц тоже занят",
    ],
    "objection_competitor": [
        # CRM упоминания
        "уже есть crm", "используем битрикс", "у нас амо", "есть система",
        "уже пользуемся", "работаем в другой",
        # Конкретные системы
        "сидим на битриксе", "внедрили амо", "перешли на мегаплан",
        "используем salesforce", "подключили pipedrive", "работаем в hubspot",
        # Своя разработка
        "у нас своя система", "самописная crm", "написали сами",
        "своя разработка", "кастомное решение",
        # Замена
        "менять не планируем", "устраивает текущая", "привыкли к своей",
        "не хотим переучиваться", "переход дорого обойдётся",
        # Дополнительные
        "уже внедрили другую систему", "недавно купили crm",
        "вложились в битрикс", "оплатили амо на год вперёд",
        "команда обучена на другой системе", "все привыкли к текущей",
        "переносить данные сложно", "миграция будет долгой",
        "у нас всё в notion", "ведём в trello",
        "работаем в excel пока нормально", "гугл таблицы устраивают",
        "бесплатной версии хватает", "используем бесплатную crm",
    ],
    "question_features": [
        # Стандартные
        "что умеете", "какие функции", "какие возможности", "что может",
        "что включено", "что входит", "как работает",
        # Конкретные вопросы
        "есть ли воронка", "есть автоматизация", "можно настроить",
        "умеете делать рассылки", "есть аналитика", "какие отчёты",
        # Сравнительные
        "чем лучше конкурентов", "какие преимущества", "в чём отличие",
        "почему вас выбрать", "что вы можете чего нет у других",
        # Технические
        "какой стек", "на чём написано", "где хранятся данные",
        "есть мобильное приложение", "работает офлайн",
        # Практические
        "сколько займёт внедрение", "нужно ли обучение", "есть поддержка",
        "как быстро отвечаете", "есть документация",
        # Дополнительные
        "какие фишки есть", "в чём ваша фишка", "какая киллер фича",
        "что умеет ваша система", "расскажите про функционал",
        "покажите возможности", "демонстрация возможностей",
        "можно автоматизировать рутину", "есть ли шаблоны",
        "можно настроить под себя", "насколько гибкая система",
        "есть api для разработчиков", "можно кастомизировать",
        "как с безопасностью", "данные защищены",
        "есть резервное копирование", "где сервера расположены",
        "можно выгрузить данные", "экспорт есть",
    ],
    "question_integrations": [
        # Стандартные
        "какие интеграции", "с чем интегрируется", "подключается ли",
        "есть интеграция с", "работает с 1с",
        # Мессенджеры
        "подключается к whatsapp", "есть телеграм бот", "интеграция с вайбер",
        "работает с вконтакте", "подключается инстаграм",
        # Телефония
        "есть интеграция с телефонией", "подключается к ats", "работает с манго",
        "можно записывать звонки", "интеграция с ip-телефонией",
        # Учётные системы
        "синхронизируется с 1с", "есть связь с бухгалтерией",
        "интеграция с мой склад", "подключается к эльбе",
        # Маркетплейсы
        "работает с авито", "подключается к wildberries", "есть озон интеграция",
        # Дополнительные
        "интеграция с вотсапом", "подключить телегу можно",
        "с вк работает", "инста подключается",
        "интеграция с ройстат", "коллтрекинг есть",
        "работает с колмагик", "интегрируется с колтач",
        "есть вебхуки", "апи открытое",
        "можно через zapier", "albato поддерживаете",
        "рассылки через sendpulse", "юнисендер интеграция",
        "с тильдой работает", "формы с сайта собирает",
        "лиды с лендинга подтягивает", "чат на сайт есть",
    ],
    "agreement": [
        # Стандартные
        "интересно", "давайте", "расскажите", "хочу попробовать", "да",
        "согласен", "подходит", "нравится", "готов", "хочу демо",
        # Активный интерес
        "покажите в деле", "хочу посмотреть", "давайте попробуем",
        "запишите на демо", "когда можно посмотреть", "как подключиться",
        # Разговорные
        "окей", "ладно", "договорились", "идёт", "пойдёт", "заметано",
        "супер", "класс", "отлично", "круто", "норм",
        # Уточняющие
        "расскажите подробнее", "а поподробнее можно", "интересно узнать больше",
        "хочу детали", "что ещё умеете",
        # Дополнительные
        "звучит интересно", "звучит неплохо", "заинтересовали",
        "заинтриговали", "любопытно", "хочется попробовать",
        "было бы интересно посмотреть", "можно глянуть",
        "го демо", "погнали", "поехали", "стартуем",
        "давай попробуем", "почему бы и нет", "можно попробовать",
        "запишите меня", "записывайте", "бронируйте время",
        "когда можно созвониться", "когда удобно показать",
        "готов посмотреть", "готовы к демо", "ждём презентацию",
    ],
    "rejection": [
        # Стандартные
        "не интересно", "не нужно", "нет", "отстаньте", "не хочу",
        "не буду", "отказываюсь", "не надо",
        # Резкие
        "отвалите", "хватит спамить", "прекратите", "достали",
        "сколько можно", "не пишите больше", "заблокирую",
        # Вежливые
        "спасибо не надо", "благодарю но нет", "пожалуй откажусь",
        "воздержусь", "обойдёмся", "справимся сами",
        # Скептичные
        "не верю в это", "сомневаюсь что поможет", "вряд ли нам подойдёт",
        "не наш вариант", "не для нас",
        # Дополнительные
        "неинтересно совсем", "абсолютно не нужно", "точно нет",
        "без вас обойдёмся", "без вас справимся", "пас",
        "отписывайте меня", "удалите мой контакт", "уберите из базы",
        "надоели", "утомили", "замучили", "задолбали уже",
        "не актуально для нас", "мимо кассы", "не по адресу",
        "это не для нашей компании", "нам это не подходит",
        "мы не ваша целевая аудитория", "не наш профиль",
    ],
}

# Веса для разных методов классификации
CLASSIFIER_CONFIG = {
    "root_match_weight": 1.0,      # Вес совпадения по корню
    "phrase_match_weight": 2.0,    # Вес точного совпадения фразы
    "lemma_match_weight": 1.5,     # Вес совпадения по лемме
    "high_confidence_threshold": 0.7,  # Порог для быстрого возврата
    "min_confidence": 0.3,         # Минимальная уверенность для unclear
}

# =============================================================================
# СОСТОЯНИЯ И ПЕРЕХОДЫ
# =============================================================================

SALES_STATES = {
    "greeting": {
        "goal": "Поздороваться и узнать чем помочь",
        "required_data": [],
        "transitions": {
            # Переход в qualification только когда клиент сам начинает разговор
            "price_question": "qualification",
            "question_features": "qualification",
            "question_integrations": "qualification",
            "agreement": "qualification",
            "info_provided": "qualification",
            "objection_competitor": "qualification",
            # На rejection сразу мягко закрываем
            "rejection": "soft_close",
        },
        "rules": {
            # На приветствие просто здороваемся
            "greeting": "greet_back",
            # На непонятное — спрашиваем чем помочь
            "unclear": "ask_how_to_help",
        }
    },

    "qualification": {
        "goal": "Узнать размер компании и боль клиента",
        "required_data": ["company_size", "pain_point"],
        "transitions": {
            "data_complete": "presentation",
            "rejection": "soft_close"
        },
        "rules": {
            "price_question": "deflect_and_continue"
        }
    },
    
    "presentation": {
        "goal": "Показать ценность продукта",
        "required_data": [],
        "transitions": {
            "agreement": "close",
            "objection_price": "handle_objection",
            "rejection": "soft_close"
        },
        "rules": {
            "price_question": "answer_with_facts"
        }
    },
    
    "handle_objection": {
        "goal": "Отработать возражение",
        "required_data": [],
        "transitions": {
            "agreement": "close",
            "rejection": "soft_close"
        },
        "rules": {}
    },
    
    "close": {
        "goal": "Взять контакт или назначить демо",
        "required_data": ["contact_info"],
        "transitions": {
            "data_complete": "success",
            "rejection": "soft_close"
        },
        "rules": {}
    },
    
    "success": {
        "goal": "Завершить успешно",
        "is_final": True
    },
    
    "soft_close": {
        "goal": "Вежливо завершить",
        "is_final": True
    }
}

# =============================================================================
# БАЗА ЗНАНИЙ
# =============================================================================

KNOWLEDGE = {
    "pricing": {
        "basic": {"name": "Базовый", "price": 990, "users": "1-5"},
        "team": {"name": "Команда", "price": 790, "users": "6-25"},
        "business": {"name": "Бизнес", "price": 590, "users": "26+"}
    },
    "features": [
        "Воронка продаж",
        "Автоматические напоминания", 
        "История клиента",
        "Отчёты"
    ],
    "discount_annual": 20
}

# =============================================================================
# ШАБЛОНЫ ПРОМПТОВ
# =============================================================================

SYSTEM_PROMPT = """Ты менеджер по продажам CRM-системы.

СТРОГО: Отвечай ТОЛЬКО на русском языке. Никогда не переключайся на другие языки.

Правила общения:
- Говори на "вы", дружелюбно, без давления
- Отвечай кратко: 2-3 предложения максимум
- Задавай только ОДИН вопрос за раз"""

PROMPT_TEMPLATES = {
    "greet_back": """{system}

Задача: Просто поздороваться в ответ и спросить чем можете помочь.
НЕ задавай вопросов о компании или команде — просто узнай что интересует клиента.

Клиент: "{user_message}"

Ответ на русском (1-2 коротких предложения):""",

    "ask_how_to_help": """{system}

Задача: Вежливо спросить чем можете помочь.
НЕ задавай конкретных вопросов — просто узнай что интересует клиента.

Диалог:
{history}

Клиент: "{user_message}"

Ответ на русском (1-2 коротких предложения):""",

    "greeting": """{system}

Задача: Поздороваться и спросить чем можете помочь.
Клиент: "{user_message}"

Ответ на русском (1-2 предложения):""",

    "qualification": """{system}

Задача: Узнать сколько человек работает с клиентами.
Клиент проявил интерес к продукту.

Диалог:
{history}

Клиент: "{user_message}"

Задай ОДИН короткий вопрос о размере команды.
Ответ на русском (1-2 предложения, без приветствия):""",

    "deflect_and_continue": """{system}

Ситуация: Клиент спросил о цене, но мы не знаем размер его команды.
Задача: Мягко уйти от цены, спросить сколько человек будет работать в системе.

Диалог:
{history}

Клиент: "{user_message}"

Задай ОДИН вопрос о размере команды (не о проблемах).
Ответ на русском (1-2 предложения, без приветствия):""",

    "continue_current_goal": """{system}

Уже знаем о клиенте: {collected_data}
Нужно узнать: {missing_data}

Диалог:
{history}

Клиент: "{user_message}"

Если нужно узнать company_size — спроси сколько человек в команде.
Если нужно узнать pain_point — спроси какую задачу хотят решить или что не устраивает сейчас.
Задай только ОДИН вопрос.
Ответ на русском (1-2 предложения, без приветствия):""",

    "presentation": """{system}

Информация о клиенте:
- Размер команды: {company_size} человек
- Проблема: {pain_point}

Наш продукт: {facts}

Задача: Кратко покажи как наш продукт решает именно ЕГО проблему.

Диалог:
{history}

Клиент: "{user_message}"

Ответ на русском (3-4 предложения, без приветствия):""",

    "handle_objection": """{system}

Ситуация: Клиент говорит что дорого.
Информация о клиенте:
- Проблема: {pain_point}
- Размер: {company_size} человек

Наш продукт: {facts}

Задача: Отработай возражение. Используй технику:
- Сравни с ценой проблемы ("сколько теряете на...")
- Или раздели на день/человека
- Упомяни скидку 20% за год

Диалог:
{history}

Клиент: "{user_message}"

Ответ на русском (2-3 предложения, без давления):""",

    "answer_with_facts": """{system}

Клиент спрашивает о продукте. Вот точные данные:
{facts}

Диалог:
{history}

Клиент: "{user_message}"

Ответь точно по фактам, на русском (2-3 предложения):""",

    "soft_close": """{system}

Ситуация: Клиент не заинтересован.
Задача: Вежливо завершить разговор, поблагодарить за время, оставить дверь открытой.

Клиент: "{user_message}"

Ответ на русском (1-2 предложения):""",

    "close": """{system}

Ситуация: Клиент заинтересован.
Задача: Предложить конкретный следующий шаг — демо или тестовый период. Попросить контакт.

Диалог:
{history}

Клиент: "{user_message}"

Ответ на русском (2-3 предложения):"""
}